<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>Confetch</h1>
<p><strong>Configur-ed/able fetch</strong></p>
<p><a href="https://github.com/prettier/prettier"><img src="https://img.shields.io/badge/code_style-prettier-ff69b4.svg?style=flat-square" alt="code style: prettier"></a>
<a href="https://codecov.io/gh/akshay-nm/confetch"><img src="https://codecov.io/gh/akshay-nm/confetch/branch/main/graph/badge.svg?token=4WB73CELH0" alt="codecov"></a></p>
<h2>tldr;</h2>
<p>This is a wrapper over <code>window.fetch</code>. Go through <a href="https://github.com/akshay-nm/confetch-example">https://github.com/akshay-nm/confetch-example</a> for more details.</p>
<p>This package also has a default <code>responseHandler</code> which you can use. The <code>responseHandler</code> just resolves the <code>res.json()</code> promise if possible, otherwise throws the errors based on statusCodes. You can pass the errors as an object.</p>
<pre class="prettyprint source lang-jsx"><code>const { configureStatusCodeBasedErrors, configureConfetch } = require('@akshay-nm/confetch')

// The new object is merged (it does not replace the default status codes configuration).
configureStatusCodeBasedErrors({
  400: 'CUSTOM ERROR MESSAGE TO BE THROWN IF THE RESPONSE CODE IS 400',
}) // This will make sure that all requestHandlers throw error with the custom message whenever the resposne status code is 400

configureConfetch({
  baseUrl: 'YOUR_BASE_URL', // this is the only parameter you NEED to pass (otherwise confetch will throw)
})

...

const { buildResponseHandler, getUrlFromPath } = require('@akshay-nm/confetch')

const responseHandler1 = buildResponseHandler() // This will throw errors preconfigured message
const responseHandler2 = buildResponseHandler({ 400: 'OTHER CUSTOM MESSAGE' }) // This will throw error with 'OTHER CUSTOM MESSAGE' on 400

confetch({
  url: getUrlFromPath('YOUR_PATH?YOUR_QUERY'),
  ... // rest of parameters for fetch
}).send().then(responseHander1).catch(console.log) // this will log the global message in case of a 400 (configured using configureStatusCodeBasedErrors)

confetch({
  url: getUrlFromPath('YOUR_PATH?YOUR_QUERY'),
  ... // rest of parameters for fetch
}).send().then(responseHander1).catch(console.log) // this will log 'OTHER CUSTOM MESSAGE' in case of 400 (configured via buildResponseHandler)

</code></pre>
<p>Since the response handler just tries to convert the response into JSON, it either returns a promise or just throws the errors.</p>
<h2>Some details</h2>
<p>Following configuration options are supported:</p>
<ul>
<li><code>baseUrl</code>: You can specify a base url and use the <code>getUrlFromPath</code> method to get complete urls for your requests.</li>
<li><code>timeoutDuration</code>: This is the duration after which your requests will be aborted.</li>
<li><code>headers</code>: This is an object (just like what you would pass to a simple <code>fetch</code> call).</li>
</ul>
<p>All the configuration parameters are merged with info object passed to a <code>confetch</code> call. So you can override the default paramaters while creating configured fetch requests, if that's what you want.</p>
<p>The package also exposes <code>confetch</code> method which basically returns an object with 3 properties:</p>
<ul>
<li><code>request</code></li>
<li><code>send</code></li>
<li><code>abort</code></li>
<li><code>controller</code></li>
<li><code>signal</code></li>
<li><code>timeout</code></li>
</ul>
<p>The ones which you should be interested in are:</p>
<ul>
<li><code>send</code></li>
<li><code>abort</code></li>
</ul>
<p>You call <code>send</code> to send the configured requests and <code>abort</code> to manually abort the request.
Both of them return a promise.</p>
<p>So this is how it would look like:</p>
<pre class="prettyprint source lang-jsx"><code>const { configure } = require('@akshay-nm/confetch')
confetchConfiguration = {
  baseUrl: 'https://some.org',
  timeoutDuration = 3000,
  headers = {
    'Content-Type': 'application/json'
  }
}
configure(confetchConfiguration)

...
const { confetch } = require('@akshay-nm/confetch')
const info = {
  url: getUrlFromPath(`/some-path?some=query`),
  method: 'GET',
  headers: {
    'Some-Request-Specific-Header': 'ITS_VALUE'
  }
}

// initialise, send, abort
const request = confetch(info)
request.send()
  .then(res => {
    /*do something with res/*
  })
  .catch(error => {
    /*handle error*/
  })
request.abort()

// fire and forget
confetch(info).send()
  .then(res => {
    /*do something with res/*
  })
  .catch(error => {
    /*handle error*/
  })
</code></pre>
<h3>What's next?</h3>
<ul>
<li>Some pre-configured fetches</li>
</ul></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#confetch">confetch</a></li><li><a href="global.html#configure">configure</a></li><li><a href="global.html#configureConfetch">configureConfetch</a></li><li><a href="global.html#getConfetchConfiguration">getConfetchConfiguration</a></li><li><a href="global.html#getCurrentGlobalConfiguration">getCurrentGlobalConfiguration</a></li><li><a href="global.html#getUrlFromPath">getUrlFromPath</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Mon Apr 05 2021 21:51:30 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>